<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <title>Categories - Admin Dashboard</title>

    <link rel="stylesheet" href="https://unpkg.com/primeflex@3.3.1/primeflex.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/primeicons/6.0.1/primeicons.min.css" />

    <style>
        body {
            background: #eef3fb;
            font-family: "Segoe UI", sans-serif;
            margin: 0;
        }

        .scrollable-table {
            overflow-x: auto;
        }

        .topbar {
            height: 70px;
            background: #ffffff;
            display: flex;
            align-items: center;
            padding: 0 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .app-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }
    </style>
</h:head>

<h:body>
    <div class="flex flex-column h-screen">

        <!-- Top Bar -->
        <div class="topbar">
            <h:outputText value="Coup Admin Dashboard" styleClass="app-title"/>
        </div>

        <div class="flex-grow-1 overflow-auto">
            <div class="flex">

                <!-- Sidebar -->
                <div class="sidebar p-shadow-3 p-component"
                     style="width: 240px; min-height: calc(100vh - 70px); background-color: #ffffff;">

                    <div style="padding: 10px;">
                        <a href="Admin.xhtml" class="block mb-3 flex align-items-center">
                            <i class="pi pi-home mr-2"></i> Dashboard
                        </a>

                        <a href="Categories.xhtml" class="block mb-3 flex align-items-center">
                            <i class="pi pi-medkit mr-2"></i> Categories
                        </a>

                        <a href="Medicines.xhtml" class="block mb-3 flex align-items-center">
                            <i class="pi pi-tags mr-2"></i> Medicines
                        </a>

                        <a href="Users.xhtml" class="block mb-3 flex align-items-center">
                            <i class="pi pi-users mr-2"></i> Users
                        </a>

                        <a href="Orders.xhtml" class="block mb-3 flex align-items-center">
                            <i class="pi pi-shopping-bag mr-2"></i> Orders
                        </a>

                        <a href="Login.xhtml" class="block mb-3 flex align-items-center" style="color: red;">
                            <i class="pi pi-power-off mr-2"></i> Logout
                        </a>
                    </div>
                </div>

                <!-- MAIN CONTENT -->
                <h:form id="categoriesForm" style="margin-left: 5%; width: 80%;">

                    <p:growl id="msgs" showDetail="true" />

                    <p:commandButton value="Add Category"
                                     icon="pi pi-plus"
                                     styleClass="p-button-success mb-3"
                                     update=":categoryDialog"
                                     actionListener="#{adminBean.openNewCategory}"
                                     oncomplete="PF('categoryDialog').show()" />

                    <div class="scrollable-table">
                        <!-- Categories Table -->
                        <p:dataTable id="categoriesTable"
                                     value="#{adminBean.categoriesList}"
                                     var="c" paginator="true"
                                     rows="10">

                            <p:column headerText="ID">
                                <h:outputText value="#{c.categoryId}" />
                            </p:column>

                            <p:column headerText="Name">
                                <h:outputText value="#{c.name}" />
                            </p:column>

                            <p:column headerText="Description">
                                <h:outputText value="#{c.description}" />
                            </p:column>

                            <p:column headerText="Actions">
                                <p:commandButton icon="pi pi-pencil"
                                                 update=":categoryDialog"
                                                 actionListener="#{adminBean.openEditCategory(c)}"
                                                 oncomplete="PF('categoryDialog').show()"
                                                 styleClass="p-button-rounded p-button-warning mr-2" />

                                <p:commandButton icon="pi pi-trash"
                                                 actionListener="#{adminBean.deleteCategory(c)}"
                                                 update="categoriesForm"
                                                 styleClass="p-button-rounded p-button-danger" />
                            </p:column>

                        </p:dataTable>
                    </div>
                </h:form>

                <!-- CATEGORY DIALOG -->
                <p:dialog id="categoryDialog" widgetVar="categoryDialog"
                          header="Category" modal="true"
                          closable="true" draggable="false" resizable="false">

                    <h:form id="categoryDialogForm">
                        <h:panelGrid columns="2" cellpadding="8">

                            <h:outputLabel value="Name:"/>
                            <p:inputText value="#{adminBean.selectedCategory.name}" required="true"/>

                            <h:outputLabel value="Description:"/>
                            <p:inputTextarea value="#{adminBean.selectedCategory.description}"/>
                        </h:panelGrid>

                        <f:facet name="footer">
                            <p:commandButton value="Save"
                                             actionListener="#{adminBean.saveCategory}"
                                             update=":categoriesForm"
                                             oncomplete="PF('categoryDialog').hide()" />

                            <p:commandButton value="Cancel" type="button"
                                             onclick="PF('categoryDialog').hide()" />
                        </f:facet>

                    </h:form>
                </p:dialog>

            </div>
        </div>
    </div>
</h:body>
</html>
